

const worksteps = workstepsByKPI[userKPI.Id] || [];

new TableCell({
  margins: {
    right: 300,
    top: 80,
    bottom: 80
  },
  children: [
    // KPI description
    new Paragraph({
      text:
        userKPI.SubCategory === "Financial"
          ? `${userKPI.KPIDescription} (Q${userKPI.Start} - Q${userKPI.End})`
          : userKPI.KPIDescription,
      style: "tableRow"
    }),

    // Financial table (if any)
    ...(userKPI.SubCategory === "Financial"
      ? [
          new Paragraph({}),
          createFinancialSubTable(previousYearTitle, userKPI)
        ]
      : []),

    // Worksteps table (if any)
    ...(worksteps.length > 0
      ? [
          new Paragraph({}), // spacing
          createWorkstepsTable(worksteps)
        ]
      : [])
  ]
})
