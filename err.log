public async completeTaskWithHistory(params: {
    task: INintexTask;
    outcome: string;
    comment: string;
    caseItemId: number;
  }): Promise<void> {

    if (!params.comment || !params.comment.trim()) {
      throw new Error("Comment is mandatory.");
    }

    await this.completeFlexiTask(
      params.task.sharePointTaskId,
      params.outcome,
      params.comment,
      params.task.taskListName
    );

    await this.logActionHistory({
      caseItemId: params.caseItemId,
      taskId: params.task.sharePointTaskId,
      taskName: params.task.taskName,
      action: params.outcome,
      comment: params.comment
    });
  }
