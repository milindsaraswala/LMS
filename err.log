private renderCaseScreen(): React.ReactElement<any> {
    const { customer, cards, status, message, secondsLeft, requestId, transactions, previousCaseRows, loadingExisting, submitting } = this.state;

    const isCreatingCase = this.state.isNewCase === true && this.state.status === "approved";

    return (
      <div>
        <button style={{ marginBottom: 10 }} onClick={() => this.setState({ view: "dashboard" })}>
          Back to Dashboard
        </button>

        {this.state.caseItemId && (
          <div style={{ marginBottom: 12 }}>
            <span
              style={{
                padding: "4px 10px",
                borderRadius: 12,
                fontSize: 12,
                fontWeight: 600,
                color: "#fff",
                background: this.getCaseBadgeColor()
              }}>
              {this.getCaseBadgeText()}
            </span>
          </div>
        )}

        {this.state.view === "newCase" && <CustomerLookup apiBaseUrl={this.props.apiBaseUrl} onCustomerFound={this.onCustomerFound} onCustomerNotFound={this.onCustomerNotFound} />}

        {customer && (
          <div style={{ marginTop: 12, border: "1px solid #ddd", padding: 12, borderRadius: 4 }}>
            <div style={{ marginBottom: 8 }}>
              <b>Customer:</b> {customer.fullNameEn} / {customer.fullNameAr}
            </div>
            <div style={{ marginBottom: 8 }}>
              <b>Civil ID</b> {customer.civilId}
            </div>

            <div style={{ marginTop: 10 }}>
              <label>
                <input type="checkbox" checked={this.state.mockPaci} onChange={(e) => this.setState({ mockPaci: (e.target as HTMLInputElement).checked })} /> Mock PACI Approval
                (testing)
              </label>
            </div>
            <button
              onClick={() => this.startPaciAuth()}
              disabled={status === "starting" || status === "waiting" || (previousCaseRows.length > 0 && !this.state.isNewCase)}
              style={{ padding: "8px 14px" }}>
              Authenticate with PACI
            </button>

            {status === "waiting" && (
              <div style={{ marginTop: 10 }}>
                <div>
                  <b>RequestId:</b> {requestId}
                </div>
                <div>
                  <b>Time left:</b> {secondsLeft}s
                </div>
              </div>
            )}

            {message && <div style={{ marginTop: 10 }}>{message}</div>}

            {/* Existing transactions */}
            {previousCaseRows.length > 0 && (
              <div
                style={{
                  background: "#fff3cd",
                  border: "1px solid #ffeeba",
                  padding: 8,
                  marginTop: 10,
                  marginBottom: 10,
                  fontSize: 13
                }}>
                This customer already has <b>{previousCaseRows.length}</b> previous case(s).
              </div>
            )}
            {/* {previousCaseRows.length > 0 && (
              <div style={{ marginTop: 14 }}>
                <h4 style={{ margin: "10px 0" }}>Previous Transactions</h4>
                {loadingExisting ? <div>Loading previous transactions...</div> : this.renderExistingTable(previousCaseRows)}
                <div style={{ marginTop: 10, color: "#b00020", fontWeight: 600 }}>This customer has previous case(s). You may proceed to create new case.</div>
              </div>
            )} */}

            {/* After PACI approval - allow adding multiple transactions */}
            {isCreatingCase && !this.state.isCaseLocked && cards && cards.length > 0 && (
              <div
                style={{
                  marginTop: 14,
                  borderTop: "1px solid #eee",
                  paddingTop: 12
                }}>
                <h4 style={{ marginTop: 0 }}>Add Transactions</h4>

                <button onClick={this.addTransactionRow} style={{ padding: "6px 12px" }}>
                  + Add Transaction
                </button>

                {transactions.length === 0 && <div style={{ marginTop: 10 }}>No transactions added yet.</div>}

                {transactions.map((t) => this.renderTransactionRow(t, cards))}

                <div style={{ marginTop: 12 }}>
                  <button onClick={this.submitToSharePoint} disabled={submitting || transactions.length === 0} style={{ padding: "8px 14px" }}>
                    {submitting ? "Submitting..." : "Submit"}
                  </button>
                </div>
              </div>
            )}

            {this.state.view === "openCase" && Array.isArray(this.state.currentCaseRows) && this.state.currentCaseRows.length > 0 && (
              <div style={{ marginTop: 16 }}>
                <h4>Current Case (Just Created)</h4>

                {this.renderExistingTable(this.state.currentCaseRows)}
              </div>
            )}

            {this.state.caseItemId && !this.state.isCaseLocked && this.state.view === "openCase" && this.state.currentCaseRows && this.state.currentCaseRows.length > 0 && (
              <div style={{ marginTop: 16, paddingTop: 12, borderTop: "1px solid #ddd" }}>
                <button
                  onClick={this.submitCaseForWorkflow}
                  disabled={this.state.submitting || this.state.payuInProgress === true}
                  style={{
                    padding: "10px 18px",
                    background: "#0078d4",
                    color: "#fff",
                    border: "none",
                    borderRadius: 3,
                    fontWeight: 600
                  }}>
                  Submit Case for Processing
                </button>
              </div>
            )}

            {this.state.view === "openCase" && this.state.caseItemId && this.state.isCaseLocked && (
              <WorkflowActionPanel
                nintexSvc={this.nintexSvc}
                caseSvc={this.caseSvc}
                listName="DisputeCases"
                itemId={this.state.caseItemId}
                onActionCompleted={() => {
                  this.setState({
                    view: "dashboard",
                    message: undefined,
                    selectedCaseId: undefined,
                    customer: undefined,
                    cards: undefined,
                    previousCaseRows: [],
                    currentCaseRows: [],
                    isCaseLocked: false
                  });
                }}
              />
            )}

            {this.state.caseItemId && <CaseActionHistoryPanel nintexSvc={this.nintexSvc} caseItemId={this.state.caseItemId} />}

            {this.state.showCommentModal && (
              <div
                style={{
                  position: "fixed",
                  top: 0,
                  left: 0,
                  right: 0,
                  bottom: 0,
                  background: "rgba(0,0,0,0.4)",
                  display: "flex",
                  alignItems: "center",
                  justifyContent: "center",
                  zIndex: 1000
                }}>
                <div
                  style={{
                    background: "#fff",
                    padding: 16,
                    width: 450,
                    maxHeight: "70%",
                    overflowY: "auto",
                    borderRadius: 4
                  }}>
                  <h4>Transaction Comment</h4>

                  <div
                    style={{
                      whiteSpace: "pre-wrap",
                      marginTop: 8,
                      fontSize: 14
                    }}>
                    {this.state.selectedComment}
                  </div>

                  <div style={{ textAlign: "right", marginTop: 16 }}>
                    <button
                      onClick={() =>
                        this.setState({
                          showCommentModal: false,
                          selectedComment: undefined
                        })
                      }>
                      Close
                    </button>
                  </div>
                </div>
              </div>
            )}

            {/* {this.state.isCaseLocked && (
              <div
                style={{
                  marginTop: 12,
                  padding: 10,
                  background: "#e7f3ff",
                  border: "1px solid #90caf9",
                  color: "#0d47a1",
                  fontWeight: 600
                }}>
                This case has been submitted for processing and is now read-only.
              </div>
            )} */}

            {/* {this.state.currentCaseRows && this.state.currentCaseRows.length > 0 && (
              <div style={{ marginTop: 16 }}>
                <h4>Current Case (Just Created)</h4>

                {this.renderExistingTable(this.state.currentCaseRows)}
              </div>
            )} */}

            {/* {previousCaseRows.length > 0 && !this.state.isNewCase && (!this.state.currentCaseRows || this.state.currentCaseRows.length === 0) && (
              <div style={{ marginTop: 12 }}>
                <button
                  onClick={() =>
                    this.setState({
                      isNewCase: true,
                      currentCaseId: this.generateCaseId(),
                      transactions: [],
                      currentCaseRows: [],
                      requestId: undefined,
                      status: "idle",
                      message: "New Case started. Please authenticate customer."
                    })
                  }
                  style={{ padding: "8px 14px" }}>
                  Create New Case
                </button>
              </div>
            )} */}

            {/* After PACI approval - allow adding multiple transactions */}
            {/* {isCreatingCase && !this.state.isCaseLocked && this.state.cards && this.state.cards.length > 0 && (
              <div style={{ marginTop: 14, borderTop: "1px solid #eee", paddingTop: 12 }}>
                <h4 style={{ marginTop: 0 }}>Add Transactions</h4>

                <button onClick={this.addTransactionRow} style={{ padding: "6px 12px" }}>
                  + Add Transaction
                </button>

                {transactions.length === 0 && <div style={{ marginTop: 10 }}>No transactions added yet.</div>}

                {transactions.map((t) => this.renderTransactionRow(t, cards))}

                <div style={{ marginTop: 12 }}>
                  <button onClick={this.submitToSharePoint} disabled={submitting || transactions.length === 0} style={{ padding: "8px 14px" }}>
                    {submitting ? "Submitting..." : "Submit"}
                  </button>
                </div>
              </div>
            )} */}
          </div>
        )}
      </div>
    );
  }
