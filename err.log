// common/CaseStatusCalculator.ts
import { TransactionStatus, CaseStatus } from "./CaseStatus";

export function calculateCaseStatus(
  txStatuses: string[]
): string {

  const unique = Array.from(new Set(txStatuses));

  if (unique.every(s => s === TransactionStatus.Rejected)) {
    return CaseStatus.Rejected;
  }

  if (unique.every(s =>
    s === TransactionStatus.FullRefundCompleted ||
    s === TransactionStatus.Rejected
  )) {
    return CaseStatus.Resolved;
  }

  if (unique.some(s => s === TransactionStatus.PartialRefundCompleted)) {
    return CaseStatus.PartiallyResolved;
  }

  if (
    unique.some(s =>
      s === TransactionStatus.RefundInitiated ||
      s === TransactionStatus.New
    )
  ) {
    return CaseStatus.InProgress;
  }

  return CaseStatus.New;
}