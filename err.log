private sendPayULinkForRow = async (
  row: IExistingDisputeRow,
  amount: number
): Promise<void> => {
  if (!amount || amount <= 0 || amount > row.txnAmount) {
    alert("Invalid refund amount.");
    return;
  }

  const ok = window.confirm(
    `Send PayU link for ${amount} on card ${row.cardMasked}?`
  );
  if (!ok) return;

  this.setState((prev) => ({
    currentCaseRows: prev.currentCaseRows.map((r) =>
      r.id === row.id ? { ...r, refundInProgress: true } : r
    )
  }));

  try {
    // ðŸ”— SAME PayU API
    await this.callPayURefundApi(row.cardExId, amount);

    const status =
      amount === row.txnAmount
        ? TransactionStatus.FullRefundCompleted
        : TransactionStatus.PartialRefundCompleted;

    const comment =
      amount === row.txnAmount
        ? "Full refund by Cards Ops"
        : `Partial refund (${amount}) by Cards Ops`;

    await this.spSvc.updateTransactionStatus(
      row.id,
      status,
      comment,
      amount
    );

    const rows = await this.spSvc.getByCaseId(this.state.currentCaseId!);
    const caseStatus = calculateCaseStatusFromTransactions(rows);

    await this.caseSvc.updateCaseStatus(
      this.state.caseItemId!,
      caseStatus,
      "Refund processed by Cards Ops"
    );

    this.setState({
      currentCaseRows: rows,
      caseStatus
    });
  } catch (e) {
    alert("Failed to send PayU link.");
    this.setState((prev) => ({
      currentCaseRows: prev.currentCaseRows.map((r) =>
        r.id === row.id ? { ...r, refundInProgress: false } : r
      )
    }));
  }
};
